var forms,i,v;for(function(n,t){typeof exports=="object"&&typeof module=="object"?module.exports=t():typeof define=="function"&&define.amd?define([],t):typeof exports=="object"?exports.aspnetValidation=t():n.aspnetValidation=t()}(window,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((i&1&&(n=t(n)),i&8)||i&4&&typeof n=="object"&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),i&2&&typeof n!="string")for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n["default"]}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s="./src/index.ts")}({"./src/index.ts":function(n,t,i){"use strict";function e(n,t){var r=t.substr(2),u="",f=n.lastIndexOf("."),e,i;return f>-1&&(u=n.substr(0,f),e=u+"."+r,i=document.getElementsByName(e)[0],i)?i:document.getElementsByName(r)[0]}var u,f,r,o;i.r(t);i.d(t,"MvcValidationProviders",function(){return r});i.d(t,"ValidationService",function(){return o});u=undefined&&undefined.__awaiter||function(n,t,i,r){return new(i||(i=Promise))(function(u,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?u(n.value):new i(function(t){t(n.value)}).then(o,s)}e((r=r.apply(n,t||[])).next())})};f=undefined&&undefined.__generator||function(n,t){function o(n){return function(t){return s([n,t])}}function s(e){if(f)throw new TypeError("Generator is already executing.");while(r)try{if(f=1,u&&(i=e[0]&2?u["return"]:e[0]?u["throw"]||((i=u["return"])&&i.call(u),0):u.next)&&!(i=i.call(u,e[1])).done)return i;(u=0,i)&&(e=[e[0]&2,i.value]);switch(e[0]){case 0:case 1:i=e;break;case 4:return r.label++,{value:e[1],done:!1};case 5:r.label++;u=e[1];e=[0];continue;case 7:e=r.ops.pop();r.trys.pop();continue;default:if(!(i=r.trys,i=i.length>0&&i[i.length-1])&&(e[0]===6||e[0]===2)){r=0;continue}if(e[0]===3&&(!i||e[1]>i[0]&&e[1]<i[3])){r.label=e[1];break}if(e[0]===6&&r.label<i[1]){r.label=i[1];i=e;break}if(i&&r.label<i[2]){r.label=i[2];r.ops.push(e);break}i[2]&&r.ops.pop();r.trys.pop();continue}e=t.call(n,r)}catch(o){e=[6,o];u=0}finally{f=i=0}if(e[0]&5)throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},f,u,i,e;return e={next:o(0),"throw":o(1),"return":o(2)},typeof Symbol=="function"&&(e[Symbol.iterator]=function(){return this}),e};r=function(){function n(){this.required=function(n){return Boolean(n)};this.stringLength=function(n,t,i){var r,u;return n?i.min&&(r=parseInt(i.min),n.length<r)?!1:i.max&&(u=parseInt(i.max),n.length>u)?!1:!0:!0};this.compare=function(n,t,i){if(!i.other)return!0;var r=e(t.name,i.other);return r?r.value===n:!0};this.range=function(n,t,i){var r,u,f;return n?(r=parseFloat(n),isNaN(r))?!1:i.min&&(u=parseFloat(i.min),r<u)?!1:i.max&&(f=parseFloat(i.max),r>f)?!1:!0:!0};this.regex=function(n,t,i){if(!n||!i.pattern)return!0;var r=new RegExp(i.pattern);return r.test(n)};this.email=function(n){if(!n)return!0;return/^([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x22([^\x0d\x22\x5c\x80-\xff]|\x5c[\x00-\x7f])*\x22))*\x40([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d)(\x2e([^\x00-\x20\x22\x28\x29\x2c\x2e\x3a-\x3c\x3e\x40\x5b-\x5d\x7f-\xff]+|\x5b([^\x0d\x5b-\x5d\x80-\xff]|\x5c[\x00-\x7f])*\x5d))*(\.\w{2,})+$/.test(n)};this.creditcard=function(n){if(!n)return!0;if(/[^0-9 \-]+/.test(n))return!1;var u=0,t=0,r=!1,i,f;if(n=n.replace(/\D/g,""),n.length<13||n.length>19)return!1;for(i=n.length-1;i>=0;i--)f=n.charAt(i),t=parseInt(f,10),r&&(t*=2)>9&&(t-=9),u+=t,r=!r;return u%10==0};this.url=function(n){if(!n)return!0;var t=new RegExp("^(?:(?:https?|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");return t.test(n)};this.phone=function(n){var t,i;return n?(t=/[\+\-\s][\-\s]/g,t.test(n))?!1:(i=/^\+?[0-9\-\s]+$/,i.test(n)):!0};this.remote=function(n,t,i){var a,r,u,o,h,c,f,y,l;if(!n)return!0;for(a=i.additionalfields.split(","),r={},u=0,o=a;u<o.length;u++){var v=o[u],f=v.substr(2),s=e(t.name,v),p=Boolean(s&&s.value);p&&(r[f]=s.value)}h=i.url;c=[];for(f in r)y=encodeURIComponent(f)+"="+encodeURIComponent(r[f]),c.push(y);return l=c.join("&"),new Promise(function(n,t){var u=new XMLHttpRequest,e,f;if(i.type==="Post"){e=new FormData;for(f in r)e.append(f,r[f]);u.open("post",h);u.setRequestHeader("Content-Type","application/x-www-form-urlencoded");u.send(l)}else u.open("get",h+"?"+l),u.send();u.onload=function(){if(u.status>=200&&u.status<300){var i=JSON.parse(u.responseText);n(i)}else t({status:u.status,statusText:u.statusText,data:u.responseText})};u.onerror=function(){t({status:u.status,statusText:u.statusText,data:u.responseText})}})}}return n}();o=function(){function n(){this.providers={};this.messageFor={};this.elementUIDs=[];this.elementByUID={};this.formInputs={};this.validators={};this.elementEvents={};this.summary={};this.debounce=300}return n.prototype.addProvider=function(n,t){this.providers[n]||(this.providers[n]=t)},n.prototype.addMvcProviders=function(){var n=new r;this.addProvider("required",n.required);this.addProvider("length",n.stringLength);this.addProvider("maxlength",n.stringLength);this.addProvider("minlength",n.stringLength);this.addProvider("equalto",n.compare);this.addProvider("range",n.range);this.addProvider("regex",n.regex);this.addProvider("creditcard",n.creditcard);this.addProvider("email",n.email);this.addProvider("url",n.url);this.addProvider("phone",n.phone);this.addProvider("remote",n.remote)},n.prototype.scanMessages=function(){for(var i,n,r=document.querySelectorAll("[data-valmsg-for]"),t=0;t<r.length;t++)i=r[t],n=i.getAttribute("data-valmsg-for"),this.messageFor[n]||(this.messageFor[n]=[]),this.messageFor[n].push(i)},n.prototype.parseDirectives=function(n){for(var i,e,r,f={},t={},o=9,u=0;u<n.length;u++)i=n[u],i.name.indexOf("data-val-")===0&&(r=i.name.substr(o),t[r]=i.value);e=function(n){var i,e,o;if(n.indexOf("-")===-1){var r=Object.keys(t).filter(function(t){return t!==n&&t.indexOf(n)===0}),u={error:t[n],params:{}},s=(n+"-").length;for(i=0;i<r.length;i++)e=t[r[i]],o=r[i].substr(s),u.params[o]=e;f[n]=u}};for(r in t)e(r);return f},n.prototype.guid4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)})},n.prototype.getElementUID=function(n){var i=this.elementUIDs.filter(function(t){return t.node===n})[0],t;return i?i.uid:(t=this.guid4(),this.elementUIDs.push({node:n,uid:t}),this.elementByUID[t]=n,t)},n.prototype.getFormValidationTask=function(n){var t=this.formInputs[n],r,i,u,f;if(!t||t.length===0)return null;for(r=[],i=0;i<t.length;i++)u=t[i],r.push(this.validators[u]);return f=r.map(function(n){return n()}),Promise.all(f).then(function(n){return n.every(function(n){return n})})},n.prototype.trackFormInput=function(n,t){var r=this,i=this.getElementUID(n),f,u;(this.formInputs[i]||(this.formInputs[i]=[]),f=this.formInputs[i].indexOf(t)===-1,f&&this.formInputs[i].push(t),this.elementEvents[i])||(u=function(t){var u=r.getFormValidationTask(i);u&&(t.preventDefault(),u.then(function(t){t&&n.submit()}).catch(function(n){console.log(n)}))},n.addEventListener("submit",u),n.addEventListener("reset",function(){for(var e,n,t,u,s=r.formInputs[i],f=0,o=s;f<o.length;f++){if(e=o[f],n=r.elementByUID[e],n.classList.remove("input-validation-error"),n.classList.remove("input-validation-valid"),t=r.messageFor[n.name],t)for(u=0;u<t.length;u++)t[u].innerHTML="";delete r.summary[e]}r.renderSummary()}),this.elementEvents[i]=u)},n.prototype.addInput=function(n){var r=this,t=this.getElementUID(n),e=this.parseDirectives(n.attributes),o=this.createValidator(n,e),u,i,f;(this.validators[t]=o,n.form&&this.trackFormInput(n.form,t),this.elementEvents[t])||(i=function(){var n=r.validators[t];clearTimeout(u);u=setTimeout(n,r.debounce)},f=n.tagName.toLowerCase()==="select",f?n.addEventListener("change",i):n.addEventListener("input",i),this.elementEvents[t]=i)},n.prototype.scanInputs=function(){for(var i,t=document.querySelectorAll('[data-val="true"]'),n=0;n<t.length;n++)i=t[n],this.addInput(i)},n.prototype.createSummaryDOM=function(){var n,i,t;if(!Object.keys(this.summary).length)return null;n=document.createElement("ul");for(i in this.summary)t=document.createElement("li"),t.innerHTML=this.summary[i],n.appendChild(t);return n},n.prototype.renderSummary=function(){var i=document.querySelectorAll('[data-valmsg-summary="true"]'),r,u,t,n;if(i.length&&(r=JSON.stringify(this.summary,Object.keys(this.summary).sort()),r!==this.renderedSummaryJSON))for(this.renderedSummaryJSON=r,u=this.createSummaryDOM(),t=0;t<i.length;t++)n=i[t],n.innerHTML="",u?(n.className="validation-summary-errors",n.appendChild(u.cloneNode(!0))):n.className="validation-summary-valid"},n.prototype.addError=function(n,t){var r=this.messageFor[n.name],i,u;if(r)for(i=0;i<r.length;i++)r[i].innerHTML=t,r[i].className="field-validation-error";n.classList.remove("input-validation-valid");n.classList.add("input-validation-error");u=this.getElementUID(n);this.summary[u]=t;this.renderSummary()},n.prototype.removeError=function(n){var i=this.messageFor[n.name],t,r;if(i)for(t=0;t<i.length;t++)i[t].innerHTML="",i[t].className="field-validation-valid";n.classList.remove("input-validation-error");n.classList.add("input-validation-valid");r=this.getElementUID(n);delete this.summary[r];this.renderSummary()},n.prototype.createValidator=function(n,t){var i=this;return function(){return u(i,void 0,void 0,function(){var u,a,e,o,c,l,i,r,s,h;return f(this,function(f){switch(f.label){case 0:u=[];for(a in t)u.push(a);e=0;f.label=1;case 1:return(e<u.length)?(o=u[e],c=t[o],l=this.providers[o],!l)?(console.log("aspnet-validation provider not implemented: "+o),[3,6]):(i=l(n.value,n,c.params),r=!1,s=c.error,!(typeof i=="boolean"))?[3,2]:(r=i,[3,5]):[3,7];case 2:return(typeof i=="string")?(r=!1,s=i,[3,5]):[3,3];case 3:return[4,i];case 4:h=f.sent();typeof h=="boolean"?r=h:(r=!1,s=h);f.label=5;case 5:if(!r)return this.addError(n,s),[2,!1];f.label=6;case 6:return e++,[3,1];case 7:return this.removeError(n),[2,!0]}})})}},n.prototype.bootstrap=function(){var n=this;this.addMvcProviders();window.addEventListener("load",function(){n.scanMessages();n.scanInputs()})},n}()}})}),forms=document.getElementsByTagName("form"),i=0;i<forms.length;i++)(function(n){for(var f,i,e=n.action,t=n.querySelectorAll("button[type=submit],input[type=submit]"),r=!1,u=0;!r&&u<t.length;u++)f=t.item(u),r=f.hasAttribute("formaction");if(r)for(i=0;i<t.length;i++)t.item(i).addEventListener("click",t=>{n.action=t.target.hasAttribute("formaction")?t.target.getAttribute("formaction"):e})})(forms.item(i));v=new aspnetValidation.ValidationService;v.bootstrap();